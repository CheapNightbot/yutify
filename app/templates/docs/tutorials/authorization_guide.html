{% extends "docs/base.html" %}

{% block main %}
<main class="container">
    <p>
        Authorization refers to the proccess of giving an app or user permission(s) to access certain resources or
        perform specific actions within a system (here <strong>{{ config["SERVICE"] }}</strong>).
        And <strong>{{ config["SERVICE"] }}</strong> implements <a href="https://datatracker.ietf.org/doc/html/rfc6749"
            rel="noopener noreferrer" target="_blank">OAuth 2.0</a>
        authorization framework for this purpose.
    </p>

    <p>
        The access to the resources is controlled by <strong>scopes</strong>, and simple enough,
        <strong>{{ config["SERVICE"] }}</strong> provides only one scope:
    </p>
    <ul>
        <li><code>activity</code>: view a user's listening activity on linked service(s).</li>
    </ul>

    <p>
        The authorization process requires valid <i>client credentials</i>: <strong>Client ID</strong> and
        <strong>Client Secret</strong>. So, if you haven't, you may follow the <a
            href="{{ url_for('docs.concepts', concept='apps') }}">Apps Guide</a> to create an app and obtain these
        credentials.
    </p>

    <p>
        The OAuth 2.0 Authorization Framework <a href="https://datatracker.ietf.org/doc/html/rfc6749#section-1.3"
            rel="noopener noreferrer" target="_blank">defines</a> four main grant types for
        obtaining access tokens, however,
        <strong>{{ config["SERVICE"] }}</strong> implements only the following grant types or flow:
    </p>
    <ul>
        <li><strong>Authorization Code</strong>
        </li>
        <li><strong>Authorization Code with PKCE</strong>: This is an extension of the Authorization Code flow that adds
            an additional layer of security by using a code verifier and code challenge. It is recommended for public
            clients (e.g., mobile apps) or where the client cannot securely store a client secret to prevent
            authorization code interception attacks.
        </li>
    </ul>

    <p>
        So, let's go through them one by one and learn how to implement them in your application to access protected
        resources on <strong>{{ config["SERVICE"] }}</strong>.
    </p>

    <h4>Prerequisites</h4>
    <p>
        Before we start, I assume that:
    </p>
    <ul>
        <li>You have created an app following the <a href="{{ url_for('docs.concepts', concept='apps') }}">Apps
                Guide</a>.</li>
        <li>You have basic understanding of either <a href="https://www.python.org/">Python</a> or <a
                href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">JavaScript</a> programming language.
        </li>
    </ul>

    <h2>Authorization Code</h2>

    <p>
        This involves redirecting the user to a login page, where they can
        authorize the application to access their data. After authorization, the application receives an
        authorization code that can be exchanged for an <a
            href="{{ url_for('docs.concepts', concept='tokens') }}">access
            token</a>.
    </p>

    <h3>Request User Authorization</h3>
    <p>
        The first step in the Authorization Code flow is to request authorization from the user so that our app can
        access
        their data. This is done by redirecting the user to the authorization endpoint with the following parameters:
    </p>
    <table>
        <thead>
            <tr>
                <th>Parameter</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>client_id</code></td>
                <td>Your app's Client ID obtained from the dashboard.</td>
            </tr>
            <tr>
                <td><code>redirect_uri</code></td>
                <td>The URL where the user will be redirected after authorization. It must match one of the redirect
                    URIs
                    specified in your app settings.</td>
            </tr>
            <tr>
                <td><code>response_type</code></td>
                <td>Must be set to <code>code</code> to indicate that we are requesting an authorization code.</td>
            </tr>
            <tr>
                <td><code>scope</code></td>
                <td>The scope of access you are requesting. As stated above, you would use <code>activity</code>.</td>
            </tr>
            <tr>
                <td><code>state</code></td>
                <td>An optional parameter that can be used to maintain state between the request and callback. It is
                    recommended to use it to prevent CSRF attacks.</td>
            </tr>
        </tbody>
    </table>
</main>
{% endblock %}
